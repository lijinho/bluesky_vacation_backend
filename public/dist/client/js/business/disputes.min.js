var daterangepicker_format=$('meta[name="daterangepicker_format"]').attr("content"),datepicker_format=$('meta[name="datepicker_format"]').attr("content");app.directive("postsPagination",function(){return{restrict:"E",template:'<ul class="pagination" ng-show="disputes_result.total"><li ng-show="disputes_result.current_page != 1"><a href="javascript:void(0)" ng-click="get_disputes_result(1)">&laquo;</a></li><li ng-show="disputes_result.current_page != 1"><a href="javascript:void(0)" ng-click="get_disputes_result(disputes_result.current_page-1)">&lsaquo; '+$("#pagin_prev").val()+' </a></li><li ng-repeat="i in [] | range:disputes_result.last_page:1" ng-class="{active : disputes_result.current_page == i}"><a href="javascript:void(0)" ng-click="get_disputes_result(i)">{{i}}</a></li><li ng-show="disputes_result.current_page != disputes_result.last_page"><a href="javascript:void(0)" ng-click="get_disputes_result(disputes_result.current_page+1)"> '+$("#pagin_next").val()+' &rsaquo;</a></li><li ng-show="disputes_result.current_page != disputes_result.last_page"><a href="javascript:void(0)" ng-click="get_disputes_result(disputes_result.last_page)">&raquo;</a></li></ul>'}}).controller("disputes",["$scope","$http",function(t,i){t.today=new Date,t.pageNumber=1,t.get_disputes_result=function(e){$("#threads").addClass("loading"),void 0===e&&(e=t.pageNumber),t.pageNumber=e;var s=t.disputes_status;i.post(APP_URL+"/get_disputes?page="+e,{status:s}).then(function(i){t.disputes_result=i.data.disputes_result,t.disputes_count=i.data.disputes_count,$("#threads").removeClass("loading")})},$(document).ready(function(){t.get_disputes_result()})}]).filter("range",function(){return function(t,i,e){void 0==e&&(e=0),i=parseInt(i);for(var s=e;s<=i;s++)t.push(s);return t}}).controller("dispute_details",["$scope","$http",function(t,i){$(".tabs li > .tab-item").click(function(){tab_target=$(this).attr("data-target"),$(".tabs .tab-item").attr("aria-selected","false"),$(".tabs-content div").attr("aria-hidden","true"),$(this).attr("aria-selected","true"),$('.tabs-content div[data-tab_content="'+tab_target+'"]').attr("aria-hidden","false")}),t.dispute_message_form_errors=[],t.keep_talking=function(){$("#dispute_controls_area").addClass("loading");var e=$("#dispute_id").val();i.post(APP_URL+"/dispute_keep_talking/"+e,t.dispute_message).then(function(i){"danger"==i.data.status?window.location.reload():"error"==i.data.status?t.dispute_message_form_errors=i.data.errors:"success"==i.data.status&&($("#thread-list").prepend(i.data.content),parseInt(t.dispute_message.amount)>0&&$(".dispute_amount_accept_panel").addClass("hide"),t.dispute_message={message:"",amount:""},t.dispute_message_form_errors=[]),$("#dispute_controls_area").removeClass("loading")})},t.involve_site_form_errors=[],t.involve_site=function(){$("#dispute_controls_area").addClass("loading");var e=$("#dispute_id").val();i.post(APP_URL+"/dispute_involve_site/"+e,t.involve_site_data).then(function(i){"danger"==i.data.status?window.location.reload():"error"==i.data.status?t.involve_site_form_errors=i.data.errors:"success"==i.data.status&&($("#thread-list").prepend(i.data.content),t.involve_site_data={message:"",amount:""},t.involve_site_form_errors=[]),$("#dispute_controls_area").removeClass("loading")})},$("#dispute_documents").on("change",function(){$("#dispute_documents_form").submit()}),t.accept_amount_form_errors=[],t.accept_amount=function(){$(".dispute_amount_accept_panel div").addClass("loading");var e=$("#dispute_id").val();i.post(APP_URL+"/dispute_accept_amount/"+e,t.accept_amount_data).then(function(i){"danger"==i.data.status?window.location.reload():"error"==i.data.status?(t.accept_amount_form_errors=i.data.errors,$(".dispute_amount_accept_panel div").removeClass("loading")):"success"==i.data.status?window.location.reload():"show_popup"==i.data.status&&(t.dispute_payment_data.message=t.accept_amount_data.message,$("#"+i.data.target).show(),$("body").addClass("pos-fix"),$(".dispute_amount_accept_panel div").removeClass("loading"))})},t.dispute_payment_data={message:""},t.dispute_form_errors=[],t.pay_dispute_amount=function(){$(".payment_popup").addClass("loading");var e=$("#dispute_id").val();i.post(APP_URL+"/dispute_pay_amount/"+e,t.dispute_payment_data).then(function(i){"danger"==i.data.status?window.location.reload():"error"==i.data.status?(t.dispute_form_errors=i.data.errors,$(".payment_popup").removeClass("loading")):"success"==i.data.status?window.location.reload():"redirect"==i.data.status&&(window.location.href=i.data.redirect_to)})}}]),$(document).on("contextmenu",'a[data-method="post"]',function(){return!1}),$(document).on("click",'a[data-method="post"]',function(){$('a[data-method="post"]').attr("disabled","disabled")}),function(t){function i(t,i,e){var s=parseInt(t.css("top"),10);if("left"==i){var a="-"+this.image_wrapper_height+"px";t.css("top",this.image_wrapper_height+"px")}else{var a=this.image_wrapper_height+"px";t.css("top","-"+this.image_wrapper_height+"px")}return e&&(e.css("bottom","-"+e[0].offsetHeight+"px"),e.animate({bottom:0},2*this.settings.animation_speed)),this.current_description&&this.current_description.animate({bottom:"-"+this.current_description[0].offsetHeight+"px"},2*this.settings.animation_speed),{old_image:{top:a},new_image:{top:s}}}function e(t,i,e){var s=parseInt(t.css("left"),10);if("left"==i){var a="-"+this.image_wrapper_width+"px";t.css("left",this.image_wrapper_width+"px")}else{var a=this.image_wrapper_width+"px";t.css("left","-"+this.image_wrapper_width+"px")}return e&&(e.css("bottom","-"+e[0].offsetHeight+"px"),e.animate({bottom:0},2*this.settings.animation_speed)),this.current_description&&this.current_description.animate({bottom:"-"+this.current_description[0].offsetHeight+"px"},2*this.settings.animation_speed),{old_image:{left:a},new_image:{left:s}}}function s(t,i,e){var s=t.width(),a=t.height(),n=parseInt(t.css("left"),10),o=parseInt(t.css("top"),10);return t.css({width:0,height:0,top:this.image_wrapper_height/2,left:this.image_wrapper_width/2}),{old_image:{width:0,height:0,top:this.image_wrapper_height/2,left:this.image_wrapper_width/2},new_image:{width:s,height:a,top:o,left:n}}}function a(t,i,e){return t.css("opacity",0),{old_image:{opacity:0},new_image:{opacity:1}}}function n(t,i,e){return t.css("opacity",0),{old_image:{opacity:0},new_image:{opacity:1},speed:0}}function o(t,i){this.init(t,i)}function r(t,i){this.init(t,i)}t.fn.adGallery=function(i){var e={loader_image:"loader.gif",start_at_index:0,update_window_hash:!0,description_wrapper:!1,thumb_opacity:.7,animate_first_image:!1,animation_speed:400,width:!1,height:!1,display_next_and_prev:!0,display_back_and_forward:!0,scroll_jump:0,slideshow:{enable:!0,autostart:!1,speed:5e3,start_label:"Start",stop_label:"Stop",stop_on_scroll:!0,countdown_prefix:"(",countdown_sufix:")",onStart:!1,onStop:!1},effect:"slide-hori",enable_keyboard_move:!0,cycle:!0,hooks:{displayDescription:!1},callbacks:{init:!1,afterImageVisible:!1,beforeImageVisible:!1}},s=t.extend(!1,e,i);i&&i.slideshow&&(s.slideshow=t.extend(!1,e.slideshow,i.slideshow)),s.slideshow.enable||(s.slideshow.autostart=!1),t(".ad-thumbs").css("top","0px"),setTimeout(function(){t(".ad-thumbs").css("top","90px")},4e3),t(".ad-nav").hover(function(){t(".ad-thumbs").css("top","0px")},function(){t(".ad-thumbs").css("top","90px")});var a=[];return t(this).each(function(){var t=new o(this,s);a[a.length]=t}),a},o.prototype={wrapper:!1,image_wrapper:!1,gallery_info:!1,nav:!1,loader:!1,preloads:!1,thumbs_wrapper:!1,thumbs_wrapper_width:0,scroll_back:!1,scroll_forward:!1,next_link:!1,prev_link:!1,slideshow:!1,image_wrapper_width:0,image_wrapper_height:0,current_index:-1,current_image:!1,current_description:!1,nav_display_width:0,settings:!1,images:!1,in_transition:!1,animations:!1,init:function(i,e){var s=this;this.wrapper=t(i),this.settings=e,this.setupElements(),this.setupAnimations(),this.settings.width?(this.image_wrapper_width=this.settings.width,this.image_wrapper.width(this.settings.width),this.wrapper.width(this.settings.width)):this.image_wrapper_width=this.image_wrapper.width(),this.settings.height?(this.image_wrapper_height=this.settings.height,this.image_wrapper.height(this.settings.height)):this.image_wrapper_height=this.image_wrapper.height(),this.nav_display_width=this.nav.width(),this.current_index=-1,this.current_image=!1,this.current_description=!1,this.in_transition=!1,this.findImages(),this.settings.display_next_and_prev&&this.initNextAndPrev();var a=function(t){return s.nextImage(t)};this.slideshow=new r(a,this.settings.slideshow),this.controls.append(this.slideshow.create()),this.settings.slideshow.enable?this.slideshow.enable():this.slideshow.disable(),this.settings.display_back_and_forward&&this.initBackAndForward(),this.settings.enable_keyboard_move&&this.initKeyEvents(),this.initHashChange();var n=parseInt(this.settings.start_at_index,10);void 0!==this.getIndexFromHash()&&(n=this.getIndexFromHash()),this.loading(!0),this.showImage(n,function(){s.settings.slideshow.autostart&&(s.preloadImage(n+1),s.slideshow.start())}),this.fireCallback(this.settings.callbacks.init)},setupAnimations:function(){this.animations={"slide-vert":i,"slide-hori":e,resize:s,fade:a,none:n}},setupElements:function(){this.controls=this.wrapper.find(".ad-controls"),this.gallery_info=t('<p class="ad-info"></p>'),this.controls.append(this.gallery_info),this.image_wrapper=this.wrapper.find(".ad-image-wrapper"),this.image_wrapper.empty(),this.nav=this.wrapper.find(".ad-nav"),this.thumbs_wrapper=this.nav.find(".ad-thumbs"),this.preloads=t('<div class="ad-preloads"></div>'),this.loader=t('<img class="ad-loader" src="../../images/'+this.settings.loader_image+'">'),this.image_wrapper.append(this.loader),this.loader.hide(),t(document.body).append(this.preloads)},loading:function(t){t?this.loader.show():this.loader.hide()},addAnimation:function(i,e){t.isFunction(e)&&(this.animations[i]=e)},findImages:function(){var i=this;this.images=[];var e=0,s=this.thumbs_wrapper.find("a"),a=s.length;this.settings.thumb_opacity<1&&s.find("img").css("opacity",this.settings.thumb_opacity),s.each(function(s){var a=t(this);a.data("ad-i",s);var n=a.attr("href"),o=a.find("img");i.whenImageLoaded(o[0],function(){var t=o[0].parentNode.parentNode.offsetWidth;0==o[0].width&&(t=100),i.thumbs_wrapper_width+=t,e++}),i._initLink(a),i.images[s]=i._createImageData(a,n)});var n=setInterval(function(){a==e&&(i._setThumbListWidth(i.thumbs_wrapper_width),clearInterval(n))},100)},_setThumbListWidth:function(t){t-=100;var i=this.nav.find(".ad-thumb-list");i.css("width",t+"px");for(var e=1,s=i.height();e<201&&(i.css("width",t+e+"px"),s==i.height());)s=i.height(),e++;i.width()<this.nav.width()&&i.width(this.nav.width())},_initLink:function(i){var e=this;i.click(function(){return e.current_index!=i.data("ad-i")&&t(".ad-controls p.ad-caption").remove(),e.showImage(i.data("ad-i")),e.slideshow.stop(),!1}).hover(function(){!t(this).is(".ad-active")&&e.settings.thumb_opacity<1&&t(this).find("img").fadeTo(300,1),e.preloadImage(i.data("ad-i"))},function(){!t(this).is(".ad-active")&&e.settings.thumb_opacity<1&&t(this).find("img").fadeTo(300,e.settings.thumb_opacity)})},_createImageData:function(t,i){var e=!1,s=t.find("img");s.data("ad-link")?e=t.data("ad-link"):s.attr("longdesc")&&s.attr("longdesc").length&&(e=s.attr("longdesc"));var a=!1;s.data("ad-desc")?a=s.data("ad-desc"):s.attr("alt")&&s.attr("alt").length&&(a=s.attr("alt"));var n=!1;s.data("ad-title")?n=s.data("ad-title"):s.attr("title")&&s.attr("title").length&&(n=s.attr("title"));var o=!1;return s.attr("data-caption")&&(o=s.attr("data-caption")),{thumb_link:t,image:i,error:!1,preloaded:!1,desc:a,title:n,size:!1,captions:o,link:e}},initKeyEvents:function(){var i=this;t(document).keydown(function(t){39==t.keyCode?(i.nextImage(),i.slideshow.stop()):37==t.keyCode&&(i.prevImage(),i.slideshow.stop())})},getIndexFromHash:function(){if(window.location.hash&&0===window.location.hash.indexOf("#ad-image-")){var t=window.location.hash.replace(/^#ad-image-/g,""),i=this.thumbs_wrapper.find("#"+t);if(i.length)return this.thumbs_wrapper.find("a").index(i);if(!isNaN(parseInt(t,10)))return parseInt(t,10)}},removeImage:function(i){if(i<0||i>=this.images.length)throw"Cannot remove image for index "+i;var e=this.images[i];this.images.splice(i,1);var s=e.thumb_link,a=s[0].parentNode.offsetWidth;this.thumbs_wrapper_width-=a,s.remove(),this._setThumbListWidth(this.thumbs_wrapper_width),this.gallery_info.html(this.current_index+1+" / "+this.images.length),this.thumbs_wrapper.find("a").each(function(i){t(this).data("ad-i",i)}),i==this.current_index&&0!=this.images.length&&this.showImage(0)},removeAllImages:function(){for(var t=this.images.length-1;t>=0;t--)this.removeImage(t)},addImage:function(i,e,s,a,n){s=s||"",a=a||"",n=n||"";var o=t('<li><a href="'+e+'" id="'+s+'"><img src="'+i+'" title="'+a+'" alt="'+n+'"></a></li>'),r=this;this.thumbs_wrapper.find("ul").append(o);var h=o.find("a"),d=h.find("img");d.css("opacity",this.settings.thumb_opacity),this.whenImageLoaded(d[0],function(){var t=d[0].parentNode.parentNode.offsetWidth;0==d[0].width&&(t=100),r.thumbs_wrapper_width+=t,r._setThumbListWidth(r.thumbs_wrapper_width)});var l=this.images.length;h.data("ad-i",l),this._initLink(h),this.images[l]=r._createImageData(h,e),this.gallery_info.html(this.current_index+1+" / "+this.images.length)},initHashChange:function(){var i=this;if("onhashchange"in window)t(window).bind("hashchange",function(){var t=i.getIndexFromHash();void 0!==t&&t!=i.current_index&&i.showImage(t)});else{var e=window.location.hash;setInterval(function(){if(window.location.hash!=e){e=window.location.hash;var t=i.getIndexFromHash();void 0!==t&&t!=i.current_index&&i.showImage(t)}},200)}},initNextAndPrev:function(){this.next_link=t('<div class="ad-next"><div class="ad-next-image icon-chevron-right icon  icon-size-4 text-contrast"></div></div>'),this.prev_link=t('<div class="ad-prev"><div class="ad-prev-image icon-chevron-left icon  icon-size-4 text-contrast"></div></div>'),this.image_wrapper.append(this.next_link),this.image_wrapper.append(this.prev_link);var i=this;this.prev_link.add(this.next_link).mouseover(function(e){t(this).css("height",i.image_wrapper_height)}).mouseout(function(t){}).click(function(){t(this).is(".ad-next")?(t(".ad-caption").hide(),i.nextImage(),i.slideshow.stop()):(t(".ad-caption").hide(),i.prevImage(),i.slideshow.stop())}).find("div").css("opacity",1)},initBackAndForward:function(){var i=this;this.scroll_forward=t('<div class="ad-forward"></div>'),this.scroll_back=t('<div class="ad-back"></div>'),this.nav.append(this.scroll_forward),this.nav.prepend(this.scroll_back);var e=0,s=!1;t(this.scroll_back).add(this.scroll_forward).click(function(){var e=i.nav_display_width-50;if(i.settings.scroll_jump>0)var e=i.settings.scroll_jump;if(t(this).is(".ad-forward"))var s=i.thumbs_wrapper.scrollLeft()+e;else var s=i.thumbs_wrapper.scrollLeft()-e;return i.settings.slideshow.stop_on_scroll&&i.slideshow.stop(),i.thumbs_wrapper.animate({scrollLeft:s+"px"}),!1}).css("opacity",.6).hover(function(){var a="left";t(this).is(".ad-forward")&&(a="right"),s=setInterval(function(){++e>30&&i.settings.slideshow.stop_on_scroll&&i.slideshow.stop();var t=i.thumbs_wrapper.scrollLeft()+1;"left"==a&&(t=i.thumbs_wrapper.scrollLeft()-1),i.thumbs_wrapper.scrollLeft(t)},10),t(this).css("opacity",1)},function(){e=0,clearInterval(s),t(this).css("opacity",.6)})},_afterShow:function(){if(this.gallery_info.html(this.current_index+1+" / "+this.images.length),this.settings.cycle||(this.prev_link.show().css("height",this.image_wrapper_height),this.next_link.show().css("height",this.image_wrapper_height),this.current_index==this.images.length-1&&this.next_link.hide(),0==this.current_index&&this.prev_link.hide()),this.settings.update_window_hash){var t=this.images[this.current_index].thumb_link;t.attr("id")?window.location.hash="#ad-image-"+t.attr("id"):window.location.hash="#ad-image-"+this.current_index}this.fireCallback(this.settings.callbacks.afterImageVisible)},_getContainedImageSize:function(t,i){if(i>this.image_wrapper_height){var e=t/i;i=this.image_wrapper_height,t=this.image_wrapper_height*e}if(i<this.image_wrapper_height){var e=t/i;i=400,t=this.image_wrapper_height*e}if(t>this.image_wrapper_width){var e=i/t;t=this.image_wrapper_width,i=this.image_wrapper_width*e}return{width:t,height:i}},_centerImage:function(t,i,e){if(t.css("top","0px"),e<this.image_wrapper_height){var s=this.image_wrapper_height-e;t.css("top",s/2+"px")}if(t.css("left","0px"),i<this.image_wrapper_width){var s=this.image_wrapper_width-i;t.css("left",s/2+"px")}},_getDescription:function(i){var e=!1;if(i.desc.length||i.title.length){var s="";i.title.length&&(s='<strong class="ad-description-title">'+i.title+"</strong>");var e="";i.desc.length&&(e="<span>"+i.desc+"</span>"),e=t('<p class="ad-image-description">'+s+e+"</p>")}return e},_getCaption:function(i){var e=!1;if(i.desc.length||i.title.length){var s="";i.title.length&&(s='<strong class="ad-caption"> : '+i.title+"</strong>");var e="";i.desc.length&&(e="<span>"+i.desc+"</span>"),e=t('<p class="ad-caption">'+s+e+"</p>")}return e},showImage:function(t,i){if(this.images[t]&&!this.in_transition&&t!=this.current_index){var e=this,s=this.images[t];this.in_transition=!0,s.preloaded?this._showWhenLoaded(t,i):(this.loading(!0),this.preloadImage(t,function(){e.loading(!1),e._showWhenLoaded(t,i)}))}},_showWhenLoaded:function(i,e){if(this.images[i]){var s=this,a=this.images[i],n=t(document.createElement("div")).addClass("ad-image"),n=t(document.createElement("div")).addClass("ad-image"),o=t(new Image).attr("src",a.image);if(a.link){var r=t('<a href="'+a.link+'" target="_blank"></a>');r.append(o),n.append(r)}else n.append(o);this.image_wrapper.prepend(n);var h=this._getContainedImageSize(a.size.width,a.size.height);o.attr("width",h.width),o.attr("height",h.height),n.css({width:h.width+"px",height:h.height+"px"}),this._centerImage(n,h.width,h.height);var d=this._getDescription(a),l=this._getCaption(a);if(d)if(this.settings.description_wrapper||this.settings.hooks.displayDescription)if(this.settings.hooks.displayDescription)this.settings.hooks.displayDescription.call(this,a);else{var c=this.settings.description_wrapper;c.append(d)}else{t(".ad-controls").append(l);var p=h.width-parseInt(d.css("padding-left"),10)-parseInt(d.css("padding-right"),10);d.css("width",p+"px")}this.highLightThumb(this.images[i].thumb_link);var g="right";if(this.current_index<i&&(g="left"),this.fireCallback(this.settings.callbacks.beforeImageVisible),this.current_image||this.settings.animate_first_image){var u=this.settings.animation_speed,_="swing",m=this.animations[this.settings.effect].call(this,n,g,d);if(void 0!==m.speed&&(u=m.speed),void 0!==m.easing&&(_=m.easing),this.current_image){var f=this.current_image,v=this.current_description;f.animate(m.old_image,u,_,function(){f.remove(),v&&v.remove()})}n.animate(m.new_image,u,_,function(){s.current_index=i,s.current_image=n,s.current_description=d,s.in_transition=!1,s._afterShow(),s.fireCallback(e)})}else this.current_index=i,this.current_image=n,s.current_description=d,this.in_transition=!1,s._afterShow(),this.fireCallback(e)}},nextIndex:function(){if(this.current_index==this.images.length-1){if(!this.settings.cycle)return!1;var t=0}else var t=this.current_index+1;return t},nextImage:function(t){var i=this.nextIndex();return!1!==i&&(this.preloadImage(i+1),this.showImage(i,t),!0)},prevIndex:function(){if(0==this.current_index){if(!this.settings.cycle)return!1;var t=this.images.length-1}else var t=this.current_index-1;return t},prevImage:function(t){var i=this.prevIndex();return!1!==i&&(this.preloadImage(i-1),this.showImage(i,t),!0)},preloadAll:function(){function t(){e<i.images.length&&(e++,i.preloadImage(e,t))}var i=this,e=0;i.preloadImage(e,t)},preloadImage:function(i,e){if(this.images[i]){var s=this.images[i];if(this.images[i].preloaded)this.fireCallback(e);else{var a=t(new Image);if(a.attr("src",s.image),this.isImageLoaded(a[0]))s.preloaded=!0,s.size={width:a[0].width,height:a[0].height},this.fireCallback(e);else{this.preloads.append(a);var n=this;a.load(function(){s.preloaded=!0,s.size={width:this.width,height:this.height},n.fireCallback(e)}).error(function(){s.error=!0,s.preloaded=!1,s.size=!1})}}}},whenImageLoaded:function(i,e){this.isImageLoaded(i)?e&&e():t(i).load(e)},isImageLoaded:function(t){return!(void 0!==t.complete&&!t.complete)&&(void 0===t.naturalWidth||0!=t.naturalWidth)},highLightThumb:function(t){this.thumbs_wrapper.find(".ad-active").removeClass("ad-active"),t.addClass("ad-active"),this.settings.thumb_opacity<1&&(this.thumbs_wrapper.find("a:not(.ad-active) img").fadeTo(300,this.settings.thumb_opacity),t.find("img").fadeTo(300,1));var i=t[0].parentNode.offsetLeft;i-=this.nav_display_width/2-t[0].offsetWidth/2,this.thumbs_wrapper.animate({scrollLeft:i+"px"})},fireCallback:function(i){t.isFunction(i)&&i.call(this)}},r.prototype={start_link:!1,stop_link:!1,countdown:!1,controls:!1,settings:!1,nextimage_callback:!1,enabled:!1,running:!1,countdown_interval:!1,init:function(t,i){this.nextimage_callback=t,this.settings=i},create:function(){this.start_link=t('<span class="ad-slideshow-start">'+this.settings.start_label+"</span>"),this.stop_link=t('<span class="ad-slideshow-stop">'+this.settings.stop_label+"</span>"),this.countdown=t('<span class="ad-slideshow-countdown"></span>'),this.controls=t('<div class="ad-slideshow-controls"></div>'),this.photo_list=t('<span class="ad-slideshow-start">'+show_photo_list+' <i class="fa fa-caret-down"></i></span>'),this.controls.append(this.photo_list),this.countdown.hide();var i=this;return this.start_link.click(function(){i.start()}),this.stop_link.click(function(){i.stop()}),t(document).keydown(function(t){83==t.keyCode&&(i.running?i.stop():i.start())}),this.controls},disable:function(){this.enabled=!1,this.stop(),this.controls.hide()},enable:function(){this.enabled=!0,this.controls.show()},toggle:function(){this.enabled?this.disable():this.enable()},start:function(){if(this.running||!this.enabled)return!1;return this.running=!0,this.controls.addClass("ad-slideshow-running"),this._next(),this.fireCallback(this.settings.onStart),!0},stop:function(){return!!this.running&&(this.running=!1,this.countdown.hide(),this.controls.removeClass("ad-slideshow-running"),clearInterval(this.countdown_interval),this.fireCallback(this.settings.onStop),!0)},_next:function(){var t=this,i=this.settings.countdown_prefix,e=this.settings.countdown_sufix;clearInterval(t.countdown_interval),this.countdown.show().html(i+this.settings.speed/1e3+e);var s=0;this.countdown_interval=setInterval(function(){if((s+=1e3)>=t.settings.speed){var a=function(){t.running&&t._next(),s=0};t.nextimage_callback(a)||t.stop(),s=0}var n=parseInt(t.countdown.text().replace(/[^0-9]/g,""),10);--n>0&&t.countdown.html(i+n+e)},1e3)},fireCallback:function(i){t.isFunction(i)&&i.call(this)}}}(jQuery),function(t,i,e,s){function a(i,e){this.el=i,this.$el=t(this.el),this.options=t.extend({},o,e),this._defaults=o,this._name=n,this.init()}var n="nivoLightbox",o={effect:"fade",theme:"default",keyboardNav:!0,clickOverlayToClose:!0,onInit:function(){},beforeShowLightbox:function(){},afterShowLightbox:function(t){},beforeHideLightbox:function(){},afterHideLightbox:function(){},onPrev:function(t){},onNext:function(t){},errorMessage:"The requested content cannot be loaded. Please try again later."};a.prototype={init:function(){var i=this;t("html").hasClass("nivo-lightbox-notouch")||t("html").addClass("nivo-lightbox-notouch"),"ontouchstart"in e&&t("html").removeClass("nivo-lightbox-notouch"),this.$el.on("click",function(t){i.showLightbox(t)}),this.options.keyboardNav&&t("body").off("keyup").on("keyup",function(e){var s=e.keyCode?e.keyCode:e.which;27==s&&i.destructLightbox(),37==s&&t(".nivo-lightbox-prev").trigger("click"),39==s&&t(".nivo-lightbox-next").trigger("click")}),this.options.onInit.call(this)},showLightbox:function(i){var e=this,s=this.$el;if(this.checkContent(s)){i.preventDefault(),this.options.beforeShowLightbox.call(this);var a=this.constructLightbox();if(a){var n=a.find(".nivo-lightbox-content");if(n){if(t("body").addClass("nivo-lightbox-body-effect-"+this.options.effect),this.processContent(n,s),this.$el.attr("data-lightbox-gallery")){var o=t('[data-lightbox-gallery="'+this.$el.attr("data-lightbox-gallery")+'"]');t(".nivo-lightbox-nav").show(),t(".nivo-lightbox-prev").off("click").on("click",function(i){i.preventDefault();var a=o.index(s);s=o.eq(a-1),t(s).length||(s=o.last()),e.processContent(n,s),e.options.onPrev.call(this,[s])}),t(".nivo-lightbox-next").off("click").on("click",function(i){i.preventDefault();var a=o.index(s);s=o.eq(a+1),t(s).length||(s=o.first()),e.processContent(n,s),e.options.onNext.call(this,[s])})}setTimeout(function(){a.addClass("nivo-lightbox-open"),e.options.afterShowLightbox.call(this,[a])},1)}}}},checkContent:function(t){var i=t.attr("href"),e=i.match(/(youtube|youtu|vimeo)\.(com|be)\/(watch\?v=([\w-]+)|([\w-]+))/);return null!==i.match(/\.(jpeg|jpg|gif|png)$/i)||(!!e||("ajax"==t.attr("data-lightbox-type")||("#"==i.substring(0,1)&&"inline"==t.attr("data-lightbox-type")||"iframe"==t.attr("data-lightbox-type"))))},processContent:function(e,s){var a=this,n=s.attr("href"),o=n.match(/(youtube|youtu|vimeo)\.(com|be)\/(watch\?v=([\w-]+)|([\w-]+))/);if(e.html("").addClass("nivo-lightbox-loading"),this.isHidpi()&&s.attr("data-lightbox-hidpi")&&(n=s.attr("data-lightbox-hidpi")),null!==n.match(/\.(jpeg|jpg|gif|png)$/i)){var r=t("<img>",{src:n});r.one("load",function(){var s=t('<div class="nivo-lightbox-image" />');s.append(r),e.html(s).removeClass("nivo-lightbox-loading"),s.css({"line-height":t(".nivo-lightbox-content").height()+"px",height:t(".nivo-lightbox-content").height()+"px"}),t(i).resize(function(){s.css({"line-height":t(".nivo-lightbox-content").height()+"px",height:t(".nivo-lightbox-content").height()+"px"})})}).each(function(){this.complete&&t(this).load()}),r.error(function(){var i=t('<div class="nivo-lightbox-error"><p>'+a.options.errorMessage+"</p></div>");e.html(i).removeClass("nivo-lightbox-loading")})}else if(o){var h="",d="nivo-lightbox-video";if("youtube"==o[1]&&(h="http://www.youtube.com/embed/"+o[4],d="nivo-lightbox-youtube"),"youtu"==o[1]&&(h="http://www.youtube.com/embed/"+o[3],d="nivo-lightbox-youtube"),"vimeo"==o[1]&&(h="http://player.vimeo.com/video/"+o[3],d="nivo-lightbox-vimeo"),h){var l=t("<iframe>",{src:h,class:d,frameborder:0,vspace:0,hspace:0,scrolling:"auto"});e.html(l),l.load(function(){e.removeClass("nivo-lightbox-loading")})}}else if("ajax"==s.attr("data-lightbox-type"))t.ajax({url:n,cache:!1,success:function(s){var a=t('<div class="nivo-lightbox-ajax" />');a.append(s),e.html(a).removeClass("nivo-lightbox-loading"),a.outerHeight()<e.height()&&a.css({position:"relative",top:"50%","margin-top":-a.outerHeight()/2+"px"}),t(i).resize(function(){a.outerHeight()<e.height()&&a.css({position:"relative",top:"50%","margin-top":-a.outerHeight()/2+"px"})})},error:function(){var i=t('<div class="nivo-lightbox-error"><p>'+a.options.errorMessage+"</p></div>");e.html(i).removeClass("nivo-lightbox-loading")}});else if("#"==n.substring(0,1)&&"inline"==s.attr("data-lightbox-type"))if(t(n).length){var c=t('<div class="nivo-lightbox-inline" />');c.append(t(n).clone().show()),e.html(c).removeClass("nivo-lightbox-loading"),c.outerHeight()<e.height()&&c.css({position:"relative",top:"50%","margin-top":-c.outerHeight()/2+"px"}),t(i).resize(function(){c.outerHeight()<e.height()&&c.css({position:"relative",top:"50%","margin-top":-c.outerHeight()/2+"px"})})}else{var p=t('<div class="nivo-lightbox-error"><p>'+a.options.errorMessage+"</p></div>");e.html(p).removeClass("nivo-lightbox-loading")}else{if("iframe"!=s.attr("data-lightbox-type"))return!1;var g=t("<iframe>",{src:n,class:"nivo-lightbox-item",frameborder:0,vspace:0,hspace:0,scrolling:"auto"});e.html(g),g.load(function(){e.removeClass("nivo-lightbox-loading")})}if(s.attr("title")){var u=t("<span>",{class:"nivo-lightbox-title"});u.text(s.attr("title")),t(".nivo-lightbox-title-wrap").html(u)}else t(".nivo-lightbox-title-wrap").html("")},constructLightbox:function(){if(t(".nivo-lightbox-overlay").length)return t(".nivo-lightbox-overlay");var i=t("<div>",{class:"nivo-lightbox-overlay nivo-lightbox-theme-"+this.options.theme+" nivo-lightbox-effect-"+this.options.effect}),e=t("<div>",{class:"nivo-lightbox-wrap"}),s=t("<div>",{class:"nivo-lightbox-content"}),a=t('<a href="#" class="nivo-lightbox-nav nivo-lightbox-prev">Previous</a><a href="#" class="nivo-lightbox-nav nivo-lightbox-next">Next</a>'),n=t('<a href="#" class="modal-close" data-behavior="modal-close" title="Close" style="font-size:65px;"></a>'),o=t("<div>",{class:"nivo-lightbox-title-wrap"});e.append(s),e.append(o),i.append(e),i.append(a),i.append(n),t("body").append(i);var r=this;return r.options.clickOverlayToClose&&i.on("click",function(i){(i.target===this||t(i.target).hasClass("nivo-lightbox-content")||t(i.target).hasClass("nivo-lightbox-image"))&&r.destructLightbox()}),n.on("click",function(t){t.preventDefault(),r.destructLightbox()}),i},destructLightbox:function(){var i=this;this.options.beforeHideLightbox.call(this),t(".nivo-lightbox-overlay").removeClass("nivo-lightbox-open"),t(".nivo-lightbox-nav").hide(),t("body").removeClass("nivo-lightbox-body-effect-"+i.options.effect);t(".nivo-lightbox-prev").off("click"),t(".nivo-lightbox-next").off("click"),t(".nivo-lightbox-content").empty(),this.options.afterHideLightbox.call(this)},isHidpi:function(){return i.devicePixelRatio>1||!(!i.matchMedia||!i.matchMedia("(-webkit-min-device-pixel-ratio: 1.5),(min--moz-device-pixel-ratio: 1.5),(-o-min-device-pixel-ratio: 3/2),(min-resolution: 1.5dppx)").matches)}},t.fn[n]=function(i){return this.each(function(){t.data(this,n)||t.data(this,n,new a(this,i))})}}(jQuery,window,document),$(function(){$(".ad-gallery").adGallery({height:400,effect:"fade"})}),$("a.gallery").nivoLightbox({effect:"fade",theme:"default",keyboardNav:!0,clickOverlayToClose:!0,onInit:function(){},beforeShowLightbox:function(){},afterShowLightbox:function(t){},beforeHideLightbox:function(){},afterHideLightbox:function(){},onPrev:function(t){},onNext:function(t){},errorMessage:"The requested content cannot be loaded. Please try again later."});
